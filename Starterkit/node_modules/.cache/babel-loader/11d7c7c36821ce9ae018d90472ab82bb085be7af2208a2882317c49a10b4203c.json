{"ast":null,"code":"import _toConsumableArray from \"/Users/michaelrellaford/Documents/gamevue/Starterkit/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.ends-with.js\";\nimport \"core-js/modules/es.string.match.js\";\nimport Vue from 'vue';\nimport VueCookies from 'vue-cookies';\n\n// array in local storage for registered users\nvar users = JSON.parse(localStorage.getItem('users')) || [{\n  username: \"admin\",\n  email: \"admin2@themesbrand.com\",\n  password: \"123456\"\n}];\nexport function configureFakeBackend() {\n  // default options config: { expires: '1d', path: '/', domain: '', secure: '', sameSite: 'Lax' }\n\n  var realFetch = window.fetch;\n  window.fetch = function (url, opts) {\n    return new Promise(function (resolve, reject) {\n      // wrap in timeout to simulate server api call\n      setTimeout(function () {\n        // authenticate\n        if (url.endsWith('/users/authenticate') && opts.method === 'POST') {\n          // get parameters from post request\n          var params = JSON.parse(opts.body);\n\n          // find if any user matches login credentials\n          var filteredUsers = users.filter(function (user) {\n            return user.email === params.email && user.password === params.password;\n          });\n\n          //////////Fake drupal oauth user - grab and store in local storage.. local \n          /////local storage is not secure for demo purposed only. SPA/decoupled apps should use \n          ////// a token handler pattern approach - https://curity.io/resources/learn/the-token-handler-pattern/?utm_source=thenewstack&utm_medium=website&utm_content=inline-mention&utm_campaign=platform\n\n          if (filteredUsers.length) {\n            // if login details are valid return user details and fake jwt token\n            // for example only passing in drupal login details for bearer token\n            var username = 'test';\n            var pass = 'Test123';\n            var client_secret = 'abc123';\n            var client_id = '7bcc8836-6c3d-4dd7-b4e2-1cd1ab39e2a3';\n            var drupaloath = 'https://dev-gametest.pantheonsite.io/oauth/token';\n            var oauthdetails = {\n              'grant_type': 'password',\n              'username': username,\n              'password': pass,\n              'client_id': client_id,\n              'client_secret': client_secret\n            };\n            var accesstoken = '';\n            var formBody = [];\n            for (var property in oauthdetails) {\n              var encodedKey = encodeURIComponent(property);\n              var encodedValue = encodeURIComponent(oauthdetails[property]);\n              formBody.push(encodedKey + \"=\" + encodedValue);\n            }\n            formBody = formBody.join(\"&\");\n            fetch(drupaloath, {\n              mode: 'cors',\n              method: \"post\",\n              headers: {\n                'Accept': 'application/vnd.api+json',\n                //'Content-Type': 'application/json'\n                'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n              },\n              //make sure to serialize your JSON body\n              body: formBody\n            }).then(function (response) {\n              return response.json();\n            }).then(function (json) {\n              accesstoken = json.access_token;\n              console.log('test');\n              localStorage.setItem('drupaltoken', accesstoken);\n            });\n\n            //.then( (response) => { \n            //do something awesome that makes the world a better place\n            //});\n\n            var user = filteredUsers[0];\n            var responseJson = {\n              id: user.id,\n              username: user.username,\n              name: user.name,\n              email: user.email,\n              token: 'fake-jwt-token'\n            };\n            resolve({\n              ok: true,\n              text: function text() {\n                return Promise.resolve(JSON.stringify(responseJson));\n              }\n            });\n          } else {\n            // else return error\n            reject('These credentials do not match our records.');\n          }\n          return;\n        }\n\n        // get users\n        if (url.endsWith('/users') && opts.method === 'GET') {\n          // check for fake auth token in header and return users if valid, this security is implemented server side in a real application\n          if (opts.headers && opts.headers.Authorization === 'Bearer fake-jwt-token') {\n            resolve({\n              ok: true,\n              text: function text() {\n                return Promise.resolve(JSON.stringify(users));\n              }\n            });\n          } else {\n            // return 401 not authorised if token is null or invalid\n            reject('Unauthorised');\n          }\n          return;\n        }\n\n        // get user by id\n        if (url.match(/\\/users\\/\\d+$/) && opts.method === 'GET') {\n          // check for fake auth token in header and return user if valid, this security is implemented server side in a real application\n          if (opts.headers && opts.headers.Authorization === 'Bearer fake-jwt-token') {\n            // find user by id in users array\n            var urlParts = url.split('/');\n            var id = parseInt(urlParts[urlParts.length - 1]);\n            var matchedUsers = users.filter(function (user) {\n              return user.id === id;\n            });\n            var _user = matchedUsers.length ? matchedUsers[0] : null;\n\n            // respond 200 OK with user\n            resolve({\n              ok: true,\n              text: function text() {\n                return JSON.stringify(_user);\n              }\n            });\n          } else {\n            // return 401 not authorised if token is null or invalid\n            reject('Unauthorised');\n          }\n          return;\n        }\n\n        // register user\n        if (url.endsWith('/users/register') && opts.method === 'POST') {\n          // get new user object from post body\n          var newUser = JSON.parse(opts.body);\n          // validation\n          var duplicateUser = users.filter(function (user) {\n            return user.username === newUser.username;\n          }).length;\n          if (duplicateUser) {\n            reject(\"Username '\" + newUser.username + \"' is already taken\");\n            return;\n          }\n\n          // save new user\n          newUser.id = users.length ? Math.max.apply(Math, _toConsumableArray(users.map(function (user) {\n            return user.id;\n          }))) + 1 : 1;\n          users.push(newUser);\n          localStorage.setItem('users', JSON.stringify(users));\n\n          // respond 200 OK\n          resolve({\n            ok: true,\n            text: function text() {\n              return Promise.resolve();\n            }\n          });\n          return;\n        }\n\n        // pass through any requests not handled above\n        realFetch(url, opts).then(function (response) {\n          return resolve(response);\n        });\n      }, 500);\n    });\n  };\n}","map":{"version":3,"names":["Vue","VueCookies","users","JSON","parse","localStorage","getItem","username","email","password","configureFakeBackend","realFetch","window","fetch","url","opts","Promise","resolve","reject","setTimeout","endsWith","method","params","body","filteredUsers","filter","user","length","pass","client_secret","client_id","drupaloath","oauthdetails","accesstoken","formBody","property","encodedKey","encodeURIComponent","encodedValue","push","join","mode","headers","then","response","json","access_token","console","log","setItem","responseJson","id","name","token","ok","text","stringify","Authorization","match","urlParts","split","parseInt","matchedUsers","newUser","duplicateUser","Math","max","apply","_toConsumableArray","map"],"sources":["/Users/michaelrellaford/Documents/gamevue/Starterkit/src/helpers/fake-backend.js"],"sourcesContent":["import Vue from 'vue'\r\nimport VueCookies from 'vue-cookies'\r\n\r\n// array in local storage for registered users\r\nlet users = JSON.parse(localStorage.getItem('users'))\r\n    || [{ username: \"admin\", email: \"admin2@themesbrand.com\", password: \"123456\" }];\r\n\r\nexport function configureFakeBackend() {\r\n     // default options config: { expires: '1d', path: '/', domain: '', secure: '', sameSite: 'Lax' }\r\n                \r\n\r\n    let realFetch = window.fetch;\r\n    window.fetch = function (url, opts) {\r\n\r\n        return new Promise((resolve, reject) => {\r\n            // wrap in timeout to simulate server api call\r\n            setTimeout(() => {\r\n\r\n                // authenticate\r\n                if (url.endsWith('/users/authenticate') && opts.method === 'POST') {\r\n                    // get parameters from post request\r\n                    let params = JSON.parse(opts.body);\r\n\r\n                    // find if any user matches login credentials\r\n                    let filteredUsers = users.filter(user => {\r\n                        return user.email === params.email && user.password === params.password;\r\n                    });\r\n\r\n\r\n                    //////////Fake drupal oauth user - grab and store in local storage.. local \r\n                    /////local storage is not secure for demo purposed only. SPA/decoupled apps should use \r\n                    ////// a token handler pattern approach - https://curity.io/resources/learn/the-token-handler-pattern/?utm_source=thenewstack&utm_medium=website&utm_content=inline-mention&utm_campaign=platform\r\n                    \r\n                    if (filteredUsers.length) {\r\n                        // if login details are valid return user details and fake jwt token\r\n                        // for example only passing in drupal login details for bearer token\r\n                        const username = 'test';\r\n                        const pass = 'Test123';\r\n                        const client_secret = 'abc123';\r\n                        const client_id = '7bcc8836-6c3d-4dd7-b4e2-1cd1ab39e2a3';\r\n                        const drupaloath = 'https://dev-gametest.pantheonsite.io/oauth/token';\r\n\r\n                        var oauthdetails = {\r\n                            'grant_type': 'password',\r\n                            'username': username,\r\n                            'password': pass,\r\n                            'client_id': client_id,\r\n                            'client_secret': client_secret,\r\n                        };\r\n\r\n                        var accesstoken = '';\r\n                        var formBody = [];\r\n                        for (var property in oauthdetails) {\r\n                          var encodedKey = encodeURIComponent(property);\r\n                          var encodedValue = encodeURIComponent(oauthdetails[property]);\r\n                          formBody.push(encodedKey + \"=\" + encodedValue);\r\n                        }\r\n                        formBody = formBody.join(\"&\");\r\n\r\n                        fetch(drupaloath, {\r\n                        mode:  'cors',\r\n                        method: \"post\",\r\n                        headers: {\r\n                            'Accept': 'application/vnd.api+json',\r\n                            //'Content-Type': 'application/json'\r\n                            'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\r\n                        },\r\n\r\n                        //make sure to serialize your JSON body\r\n                        body: formBody\r\n                        })\r\n                        .then((response) => response.json())\r\n                        .then((json) => {accesstoken = json.access_token; console.log('test');localStorage.setItem( 'drupaltoken', accesstoken);})\r\n                        \r\n\r\n                        //.then( (response) => { \r\n                        //do something awesome that makes the world a better place\r\n                        //});\r\n\r\n                        let user = filteredUsers[0];\r\n                        let responseJson = {\r\n                            id: user.id,\r\n                            username: user.username,\r\n                            name: user.name,\r\n                            email: user.email,\r\n                            token: 'fake-jwt-token'\r\n                        };\r\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(responseJson)) });\r\n                    } else {\r\n                        // else return error\r\n                        reject('These credentials do not match our records.');\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                // get users\r\n                if (url.endsWith('/users') && opts.method === 'GET') {\r\n                    // check for fake auth token in header and return users if valid, this security is implemented server side in a real application\r\n                    if (opts.headers && opts.headers.Authorization === 'Bearer fake-jwt-token') {\r\n                        resolve({ ok: true, text: () => Promise.resolve(JSON.stringify(users)) });\r\n                    } else {\r\n                        // return 401 not authorised if token is null or invalid\r\n                        reject('Unauthorised');\r\n                    }\r\n\r\n                    return;\r\n                }\r\n\r\n                // get user by id\r\n                if (url.match(/\\/users\\/\\d+$/) && opts.method === 'GET') {\r\n                    // check for fake auth token in header and return user if valid, this security is implemented server side in a real application\r\n                    if (opts.headers && opts.headers.Authorization === 'Bearer fake-jwt-token') {\r\n                        // find user by id in users array\r\n                        let urlParts = url.split('/');\r\n                        let id = parseInt(urlParts[urlParts.length - 1]);\r\n                        let matchedUsers = users.filter(user => { return user.id === id; });\r\n                        let user = matchedUsers.length ? matchedUsers[0] : null;\r\n\r\n                        // respond 200 OK with user\r\n                        resolve({ ok: true, text: () => JSON.stringify(user) });\r\n                    } else {\r\n                        // return 401 not authorised if token is null or invalid\r\n                        reject('Unauthorised');\r\n                    }\r\n\r\n                    return;\r\n                }\r\n\r\n                // register user\r\n                if (url.endsWith('/users/register') && opts.method === 'POST') {\r\n                    // get new user object from post body\r\n                    let newUser = JSON.parse(opts.body);\r\n                    // validation\r\n                    let duplicateUser = users.filter(user => { return user.username === newUser.username; }).length;\r\n                    if (duplicateUser) {\r\n                        reject(\"Username '\" + newUser.username + \"' is already taken\");\r\n                        return;\r\n                    }\r\n\r\n                    // save new user\r\n                    newUser.id = users.length ? Math.max(...users.map(user => user.id)) + 1 : 1;\r\n                    users.push(newUser);\r\n                    localStorage.setItem('users', JSON.stringify(users));\r\n\r\n                    // respond 200 OK\r\n                    resolve({ ok: true, text: () => Promise.resolve() });\r\n\r\n                    return;\r\n                }\r\n\r\n                // pass through any requests not handled above\r\n                realFetch(url, opts).then(response => resolve(response));\r\n\r\n            }, 500);\r\n        });\r\n    }\r\n}"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,UAAU,MAAM,aAAa;;AAEpC;AACA,IAAIC,KAAK,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,IAC9C,CAAC;EAAEC,QAAQ,EAAE,OAAO;EAAEC,KAAK,EAAE,wBAAwB;EAAEC,QAAQ,EAAE;AAAS,CAAC,CAAC;AAEnF,OAAO,SAASC,oBAAoBA,CAAA,EAAG;EAClC;;EAGD,IAAIC,SAAS,GAAGC,MAAM,CAACC,KAAK;EAC5BD,MAAM,CAACC,KAAK,GAAG,UAAUC,GAAG,EAAEC,IAAI,EAAE;IAEhC,OAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;MACpC;MACAC,UAAU,CAAC,YAAM;QAEb;QACA,IAAIL,GAAG,CAACM,QAAQ,CAAC,qBAAqB,CAAC,IAAIL,IAAI,CAACM,MAAM,KAAK,MAAM,EAAE;UAC/D;UACA,IAAIC,MAAM,GAAGnB,IAAI,CAACC,KAAK,CAACW,IAAI,CAACQ,IAAI,CAAC;;UAElC;UACA,IAAIC,aAAa,GAAGtB,KAAK,CAACuB,MAAM,CAAC,UAAAC,IAAI,EAAI;YACrC,OAAOA,IAAI,CAAClB,KAAK,KAAKc,MAAM,CAACd,KAAK,IAAIkB,IAAI,CAACjB,QAAQ,KAAKa,MAAM,CAACb,QAAQ;UAC3E,CAAC,CAAC;;UAGF;UACA;UACA;;UAEA,IAAIe,aAAa,CAACG,MAAM,EAAE;YACtB;YACA;YACA,IAAMpB,QAAQ,GAAG,MAAM;YACvB,IAAMqB,IAAI,GAAG,SAAS;YACtB,IAAMC,aAAa,GAAG,QAAQ;YAC9B,IAAMC,SAAS,GAAG,sCAAsC;YACxD,IAAMC,UAAU,GAAG,kDAAkD;YAErE,IAAIC,YAAY,GAAG;cACf,YAAY,EAAE,UAAU;cACxB,UAAU,EAAEzB,QAAQ;cACpB,UAAU,EAAEqB,IAAI;cAChB,WAAW,EAAEE,SAAS;cACtB,eAAe,EAAED;YACrB,CAAC;YAED,IAAII,WAAW,GAAG,EAAE;YACpB,IAAIC,QAAQ,GAAG,EAAE;YACjB,KAAK,IAAIC,QAAQ,IAAIH,YAAY,EAAE;cACjC,IAAII,UAAU,GAAGC,kBAAkB,CAACF,QAAQ,CAAC;cAC7C,IAAIG,YAAY,GAAGD,kBAAkB,CAACL,YAAY,CAACG,QAAQ,CAAC,CAAC;cAC7DD,QAAQ,CAACK,IAAI,CAACH,UAAU,GAAG,GAAG,GAAGE,YAAY,CAAC;YAChD;YACAJ,QAAQ,GAAGA,QAAQ,CAACM,IAAI,CAAC,GAAG,CAAC;YAE7B3B,KAAK,CAACkB,UAAU,EAAE;cAClBU,IAAI,EAAG,MAAM;cACbpB,MAAM,EAAE,MAAM;cACdqB,OAAO,EAAE;gBACL,QAAQ,EAAE,0BAA0B;gBACpC;gBACA,cAAc,EAAE;cACpB,CAAC;cAED;cACAnB,IAAI,EAAEW;YACN,CAAC,CAAC,CACDS,IAAI,CAAC,UAACC,QAAQ;cAAA,OAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC;YAAA,EAAC,CACnCF,IAAI,CAAC,UAACE,IAAI,EAAK;cAACZ,WAAW,GAAGY,IAAI,CAACC,YAAY;cAAEC,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;cAAC3C,YAAY,CAAC4C,OAAO,CAAE,aAAa,EAAEhB,WAAW,CAAC;YAAC,CAAC,CAAC;;YAG1H;YACA;YACA;;YAEA,IAAIP,IAAI,GAAGF,aAAa,CAAC,CAAC,CAAC;YAC3B,IAAI0B,YAAY,GAAG;cACfC,EAAE,EAAEzB,IAAI,CAACyB,EAAE;cACX5C,QAAQ,EAAEmB,IAAI,CAACnB,QAAQ;cACvB6C,IAAI,EAAE1B,IAAI,CAAC0B,IAAI;cACf5C,KAAK,EAAEkB,IAAI,CAAClB,KAAK;cACjB6C,KAAK,EAAE;YACX,CAAC;YACDpC,OAAO,CAAC;cAAEqC,EAAE,EAAE,IAAI;cAAEC,IAAI,EAAE,SAAAA,KAAA;gBAAA,OAAMvC,OAAO,CAACC,OAAO,CAACd,IAAI,CAACqD,SAAS,CAACN,YAAY,CAAC,CAAC;cAAA;YAAC,CAAC,CAAC;UACpF,CAAC,MAAM;YACH;YACAhC,MAAM,CAAC,6CAA6C,CAAC;UACzD;UACA;QACJ;;QAEA;QACA,IAAIJ,GAAG,CAACM,QAAQ,CAAC,QAAQ,CAAC,IAAIL,IAAI,CAACM,MAAM,KAAK,KAAK,EAAE;UACjD;UACA,IAAIN,IAAI,CAAC2B,OAAO,IAAI3B,IAAI,CAAC2B,OAAO,CAACe,aAAa,KAAK,uBAAuB,EAAE;YACxExC,OAAO,CAAC;cAAEqC,EAAE,EAAE,IAAI;cAAEC,IAAI,EAAE,SAAAA,KAAA;gBAAA,OAAMvC,OAAO,CAACC,OAAO,CAACd,IAAI,CAACqD,SAAS,CAACtD,KAAK,CAAC,CAAC;cAAA;YAAC,CAAC,CAAC;UAC7E,CAAC,MAAM;YACH;YACAgB,MAAM,CAAC,cAAc,CAAC;UAC1B;UAEA;QACJ;;QAEA;QACA,IAAIJ,GAAG,CAAC4C,KAAK,CAAC,eAAe,CAAC,IAAI3C,IAAI,CAACM,MAAM,KAAK,KAAK,EAAE;UACrD;UACA,IAAIN,IAAI,CAAC2B,OAAO,IAAI3B,IAAI,CAAC2B,OAAO,CAACe,aAAa,KAAK,uBAAuB,EAAE;YACxE;YACA,IAAIE,QAAQ,GAAG7C,GAAG,CAAC8C,KAAK,CAAC,GAAG,CAAC;YAC7B,IAAIT,EAAE,GAAGU,QAAQ,CAACF,QAAQ,CAACA,QAAQ,CAAChC,MAAM,GAAG,CAAC,CAAC,CAAC;YAChD,IAAImC,YAAY,GAAG5D,KAAK,CAACuB,MAAM,CAAC,UAAAC,IAAI,EAAI;cAAE,OAAOA,IAAI,CAACyB,EAAE,KAAKA,EAAE;YAAE,CAAC,CAAC;YACnE,IAAIzB,KAAI,GAAGoC,YAAY,CAACnC,MAAM,GAAGmC,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI;;YAEvD;YACA7C,OAAO,CAAC;cAAEqC,EAAE,EAAE,IAAI;cAAEC,IAAI,EAAE,SAAAA,KAAA;gBAAA,OAAMpD,IAAI,CAACqD,SAAS,CAAC9B,KAAI,CAAC;cAAA;YAAC,CAAC,CAAC;UAC3D,CAAC,MAAM;YACH;YACAR,MAAM,CAAC,cAAc,CAAC;UAC1B;UAEA;QACJ;;QAEA;QACA,IAAIJ,GAAG,CAACM,QAAQ,CAAC,iBAAiB,CAAC,IAAIL,IAAI,CAACM,MAAM,KAAK,MAAM,EAAE;UAC3D;UACA,IAAI0C,OAAO,GAAG5D,IAAI,CAACC,KAAK,CAACW,IAAI,CAACQ,IAAI,CAAC;UACnC;UACA,IAAIyC,aAAa,GAAG9D,KAAK,CAACuB,MAAM,CAAC,UAAAC,IAAI,EAAI;YAAE,OAAOA,IAAI,CAACnB,QAAQ,KAAKwD,OAAO,CAACxD,QAAQ;UAAE,CAAC,CAAC,CAACoB,MAAM;UAC/F,IAAIqC,aAAa,EAAE;YACf9C,MAAM,CAAC,YAAY,GAAG6C,OAAO,CAACxD,QAAQ,GAAG,oBAAoB,CAAC;YAC9D;UACJ;;UAEA;UACAwD,OAAO,CAACZ,EAAE,GAAGjD,KAAK,CAACyB,MAAM,GAAGsC,IAAI,CAACC,GAAG,CAAAC,KAAA,CAARF,IAAI,EAAAG,kBAAA,CAAQlE,KAAK,CAACmE,GAAG,CAAC,UAAA3C,IAAI;YAAA,OAAIA,IAAI,CAACyB,EAAE;UAAA,EAAC,EAAC,GAAG,CAAC,GAAG,CAAC;UAC3EjD,KAAK,CAACqC,IAAI,CAACwB,OAAO,CAAC;UACnB1D,YAAY,CAAC4C,OAAO,CAAC,OAAO,EAAE9C,IAAI,CAACqD,SAAS,CAACtD,KAAK,CAAC,CAAC;;UAEpD;UACAe,OAAO,CAAC;YAAEqC,EAAE,EAAE,IAAI;YAAEC,IAAI,EAAE,SAAAA,KAAA;cAAA,OAAMvC,OAAO,CAACC,OAAO,CAAC,CAAC;YAAA;UAAC,CAAC,CAAC;UAEpD;QACJ;;QAEA;QACAN,SAAS,CAACG,GAAG,EAAEC,IAAI,CAAC,CAAC4B,IAAI,CAAC,UAAAC,QAAQ;UAAA,OAAI3B,OAAO,CAAC2B,QAAQ,CAAC;QAAA,EAAC;MAE5D,CAAC,EAAE,GAAG,CAAC;IACX,CAAC,CAAC;EACN,CAAC;AACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}